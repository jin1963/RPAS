<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KJC Package Referral Auto-Stake</title>
  <link rel="stylesheet" href="style.css"/>

  <!-- Web3.js -->
  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>

  <!-- ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á DApp (‡∏°‡∏µ ABI ‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß) -->
  <script defer src="public.js"></script>

  <style>
    /* ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ style.css */
    body{background:#0f1220;color:#ffd84d;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial}
    .wrap{max-width:980px;margin:24px auto;padding:0 16px}
    .card{background:#171a2b;border:1px solid #2a2e4a;border-radius:12px;padding:18px;margin:18px 0}
    h1{font-size:28px;margin:0 0 8px}
    .muted{color:#b9b9c9;font-size:14px}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .mono{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    input[type=text]{width:100%;max-width:480px;padding:10px;border-radius:8px;border:1px solid #2c3152;background:#12162a;color:#fff}
    button{background:#ffd84d;color:#000;border:0;border-radius:8px;padding:10px 14px;font-weight:700;cursor:pointer}
    button.secondary{background:#272a42;color:#ffd84d;border:1px solid #3b3f63}
    .pkg{border:1px solid #2b3050;border-radius:10px;padding:14px;margin:12px 0;background:#141832}
    .pkg h3{margin:0 0 6px}
    .pkg .actions{margin-top:10px}
    .note{font-size:12px;color:#aeb0c6;margin-top:6px}
    @media (min-width:720px){.grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="row" style="justify-content:space-between">
      <h1>üéÅ KJC Package Referral Auto-Stake</h1>
      <div class="row">
        <button id="btnConnect" onclick="connectWallet()">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</button>
        <span class="muted">‚úÖ <span id="wallet" class="mono">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</span></span>
      </div>
    </div>
    <div class="muted">Contract: <span id="ca" class="mono">0x‚Ä¶</span></div>

    <!-- ‡∏ú‡∏π‡πâ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (Referrer) -->
    <div class="card">
      <h2>üë• ‡∏ú‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (Referrer)</h2>
      <div class="row">
        <input id="refInput" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å Address ‡∏ú‡∏π‡πâ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‡πÄ‡∏ä‡πà‡∏ô 0x..." />
        <button onclick="bindReferrer()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Referrer</button>
      </div>
      <p class="muted">* ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ú‡∏π‡∏Å Referrer ‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à</p>

      <div style="margin-top:12px">
        <div class="muted">Referrer ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤:</div>
        <div class="mono" id="refDisplay">(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)</div>
      </div>
    </div>

    <!-- ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô -->
    <div class="card">
      <h2>üîó ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
      <div class="row">
        <input id="myRefLink" type="text" readonly placeholder="(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ ‚Äì ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô)"/>
        <button class="secondary" onclick="genMyLink()">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
        <button onclick="copyRefLink()">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
      </div>
      <p class="muted">* ‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ú‡πà‡∏≤‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ú‡∏π‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
    </div>

    <!-- ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à -->
    <div class="card">
      <h2>üì¶ ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏ã‡∏∑‡πâ‡∏≠</h2>
      <div id="packageList"></div>
    </div>
  </div>

  <!-- helper ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤ HTML ‡∏ô‡∏µ‡πâ -->
  <script>
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å account ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    function genMyLink(){
      if (typeof account !== 'string' || !account) {
        document.getElementById('myRefLink').value = '(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ ‚Äì ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô)';
        return;
      }
      const url = new URL(window.location.href);
      url.searchParams.set('ref', account);
      document.getElementById('myRefLink').value = url.toString();
    }
    // ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå
    function copyRefLink(){
      const input = document.getElementById('myRefLink');
      if (!input.value) { return; }
      input.select(); input.setSelectionRange(0, 99999);
      navigator.clipboard.writeText(input.value);
      // ‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡πÜ
      const tip = document.createElement('div');
      tip.textContent = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß ‚úÖ';
      tip.style.position='fixed'; tip.style.bottom='18px'; tip.style.left='50%';
      tip.style.transform='translateX(-50%)'; tip.style.background='#20bf6b';
      tip.style.color='#fff'; tip.style.padding='8px 12px'; tip.style.borderRadius='8px';
      document.body.appendChild(tip);
      setTimeout(()=>tip.remove(),1500);
    }
    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï CA ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (‡πÄ‡∏ú‡∏∑‡πà‡∏≠ public.js ‡πÇ‡∏´‡∏•‡∏î‡∏ä‡πâ‡∏≤‡∏Å‡∏ß‡πà‡∏≤)
    document.addEventListener('DOMContentLoaded', ()=>{
      // ‡∏ñ‡πâ‡∏≤ public.js ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡πà‡∏≠‡∏ô ‡∏à‡∏∞‡∏°‡∏µ contractAddress ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà
      if (typeof contractAddress === 'string') {
        document.getElementById('ca').textContent = contractAddress;
      }
    });
  </script>
</body>
</html>
